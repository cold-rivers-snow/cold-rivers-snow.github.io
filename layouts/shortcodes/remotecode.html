{{/* Shortcode for older Hugo versions (pre v0.141.0)
  Usage: {{< remotecode "RAW_GITHUB_URL" "language" "options" >}} 
*/}}

{{ $url := .Get 0 }}
{{ $language := .Get 1 }}
{{ $options := .Get 2 }}

{{/* Attempt to fetch the remote resource. */}}
{{ $resource := resources.GetRemote $url }}

{{/* Check if the resource object exists. 
     If $resource is nil (i.e., fetch failed), the 'with' block is skipped.
*/}}
{{ with $resource }}
    {{/* Success: The resource exists. Check if it has content. */}}
    {{ if .Content }}
        {{ highlight .Content $language $options }}
    {{ else }}
        {{ errorf "ERROR: Remote file at %s was fetched, but returned empty content." $url }}
    {{ end }}
{{ else }}
    {{/* Failure: The resource object is nil (fetch failed entirely). */}}
    {{ errorf "ERROR: Failed to fetch remote resource from URL: %s. Check URL and connectivity." $url }}
{{ end }}